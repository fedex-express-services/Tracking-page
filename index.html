<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>FedEx: Shipping, Logistics Management and Supply Chain Management</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.6.0/css/all.min.css">
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
  <style>
    /* CSS Reset and Base Styles */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }
    
    :root {
      --fedex-purple: #4D148C;
      --fedex-orange: #FF6200;
      --fedex-gray: #5D5D5D;
      --fedex-light-gray: #F5F5F5;
      --fedex-dark-gray: #333333;
      --fedex-blue: #0066CC;
      --fedex-green: #10b981;
      --fedex-red: #dc2626;
      --border-radius: 8px;
      --shadow-light: 0 2px 8px rgba(0,0,0,0.1);
      --shadow-medium: 0 4px 16px rgba(0,0,0,0.15);
      --transition: all 0.3s ease;
    }
    
    /* Dark mode variables */
    [data-theme="dark"] {
      --fedex-light-gray: #2a2a2a;
      --fedex-dark-gray: #e5e5e5;
    }
    
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
      line-height: 1.6;
      color: var(--fedex-dark-gray);
      background: white;
      overflow-x: hidden;
      font-size: 16px;
    }
    
    [data-theme="dark"] body {
      background: #1a1a1a;
      color: var(--fedex-dark-gray);
    }
    
    /* Typography */
    h1, h2, h3, h4, h5, h6 {
      font-weight: 600;
      line-height: 1.3;
    }
    
    /* Header Styles */
    .header {
      background: white;
      box-shadow: var(--shadow-light);
      position: sticky;
      top: 0;
      z-index: 1000;
    }
    
    [data-theme="dark"] .header {
      background: #2a2a2a;
      border-bottom: 1px solid #444;
    }
    
    .header-top {
      background: var(--fedex-purple);
      color: white;
      padding: 12px 0;
      font-size: 14px;
    }
    
    .header-top .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 8px;
    }
    
    .header-main {
      padding: 16px 0;
    }
    
    .header-main .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 16px;
    }
    
    .logo {
      display: flex;
      align-items: center;
      text-decoration: none;
      cursor: pointer;
    }
    
    .logo-text {
      font-size: clamp(24px, 4vw, 32px);
      font-weight: bold;
      color: var(--fedex-purple);
      margin-right: 2px;
    }
    
    .logo-ex {
      font-size: clamp(24px, 4vw, 32px);
      font-weight: bold;
      color: var(--fedex-orange);
    }
    
    .nav-main {
      display: flex;
      list-style: none;
      gap: clamp(16px, 3vw, 32px);
    }
    
    .nav-main a {
      text-decoration: none;
      color: var(--fedex-gray);
      font-weight: 500;
      padding: 12px 8px;
      border-bottom: 3px solid transparent;
      transition: var(--transition);
      cursor: pointer;
      position: relative;
    }
    
    .nav-main a:hover, .nav-main a.active {
      color: var(--fedex-purple);
      border-bottom-color: var(--fedex-orange);
    }
    
    .header-actions {
      display: flex;
      gap: 12px;
      align-items: center;
      flex-wrap: wrap;
    }
    
    /* Button Styles */
    .btn {
      display: inline-flex;
      align-items: center;
      justify-content: center;
      padding: 12px 20px;
      border-radius: var(--border-radius);
      font-weight: 600;
      font-size: 16px;
      text-decoration: none;
      border: none;
      cursor: pointer;
      transition: var(--transition);
      min-height: 48px;
      min-width: 48px;
      gap: 8px;
      white-space: nowrap;
    }
    
    .btn-primary {
      background: var(--fedex-purple);
      color: white;
    }
    
    .btn-primary:hover:not(:disabled) {
      background: #3a0f6b;
      transform: translateY(-2px);
      box-shadow: var(--shadow-medium);
    }
    
    .btn-primary:disabled {
      background: #ccc;
      cursor: not-allowed;
      transform: none;
      box-shadow: none;
    }
    
    .btn-secondary {
      background: transparent;
      color: var(--fedex-purple);
      border: 2px solid var(--fedex-purple);
    }
    
    .btn-secondary:hover {
      background: var(--fedex-purple);
      color: white;
    }
    
    /* Mobile menu */
    .mobile-menu-btn {
      display: none;
      background: none;
      border: none;
      font-size: 24px;
      color: var(--fedex-purple);
      cursor: pointer;
      min-height: 48px;
      min-width: 48px;
    }
    
    .mobile-nav {
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      background: white;
      box-shadow: var(--shadow-medium);
      padding: 16px;
      z-index: 999;
    }
    
    [data-theme="dark"] .mobile-nav {
      background: #2a2a2a;
    }
    
    .mobile-nav.active {
      display: block;
    }
    
    .mobile-nav a {
      display: flex;
      align-items: center;
      padding: 16px 8px;
      border-bottom: 1px solid #eee;
      color: var(--fedex-gray);
      text-decoration: none;
      font-weight: 500;
      min-height: 48px;
      transition: var(--transition);
    }
    
    [data-theme="dark"] .mobile-nav a {
      border-bottom-color: #444;
    }
    
    .mobile-nav a:hover,
    .mobile-nav a.active {
      color: var(--fedex-purple);
      background: var(--fedex-light-gray);
    }
    
    /* Layout */
    .page-container {
      min-height: calc(100vh - 200px);
    }
    
    .page {
      display: none;
    }
    
    .page.active {
      display: block;
    }
    
    .container {
      max-width: 1200px;
      margin: 0 auto;
      padding: 0 16px;
    }
    
    .content-section {
      padding: clamp(40px, 8vw, 80px) 0;
    }
    
    .content-section.gray {
      background: var(--fedex-light-gray);
    }
    
    .section-header {
      text-align: center;
      margin-bottom: clamp(40px, 6vw, 60px);
    }
    
    .section-header h2 {
      font-size: clamp(28px, 5vw, 36px);
      color: var(--fedex-purple);
      margin-bottom: 16px;
    }
    
    .section-header p {
      font-size: clamp(16px, 2.5vw, 18px);
      color: var(--fedex-gray);
      max-width: 600px;
      margin: 0 auto;
      line-height: 1.6;
    }
    
    /* Grid Systems */
    .grid {
      display: grid;
      gap: clamp(16px, 3vw, 24px);
    }
    
    .grid-2 { grid-template-columns: repeat(auto-fit, minmax(280px, 1fr)); }
    .grid-3 { grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); }
    .grid-4 { grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); }
    
    /* Hero Section */
    .hero {
      background: linear-gradient(135deg, var(--fedex-purple) 0%, #662d91 100%);
      color: white;
      padding: clamp(40px, 8vw, 80px) 0;
      position: relative;
      overflow: hidden;
    }
    
    .hero::before {
      content: '';
      position: absolute;
      top: 0;
      right: 0;
      width: 50%;
      height: 100%;
      background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><defs><pattern id="grid" width="10" height="10" patternUnits="userSpaceOnUse"><path d="M 10 0 L 0 0 0 10" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="0.5"/></pattern></defs><rect width="100" height="100" fill="url(%23grid)"/></svg>');
      opacity: 0.3;
    }
    
    .hero .container {
      display: grid;
      grid-template-columns: 1fr;
      gap: clamp(30px, 6vw, 60px);
      align-items: center;
      position: relative;
      z-index: 1;
    }
    
    .hero-content h1 {
      font-size: clamp(32px, 6vw, 48px);
      font-weight: bold;
      margin-bottom: 20px;
      line-height: 1.2;
    }
    
    .hero-content p {
      font-size: clamp(16px, 2.5vw, 18px);
      margin-bottom: 30px;
      opacity: 0.9;
      line-height: 1.6;
    }
    
    .hero-actions {
      display: flex;
      gap: 16px;
      flex-wrap: wrap;
      margin-top: 30px;
    }
    
    /* Tracking Widget */
    .tracking-widget {
      background: white;
      padding: clamp(20px, 4vw, 30px);
      border-radius: 12px;
      box-shadow: var(--shadow-medium);
      color: var(--fedex-dark-gray);
      max-width: 100%;
    }
    
    [data-theme="dark"] .tracking-widget {
      background: #2a2a2a;
      color: var(--fedex-dark-gray);
    }
    
    .tracking-widget h3 {
      color: var(--fedex-purple);
      margin-bottom: 20px;
      font-size: clamp(20px, 3vw, 24px);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .tracking-form {
      display: flex;
      flex-direction: column;
      gap: 16px;
    }
    
    /* Card Styles */
    .card {
      background: white;
      border-radius: 12px;
      padding: clamp(20px, 4vw, 30px);
      box-shadow: var(--shadow-light);
      transition: var(--transition);
      position: relative;
      overflow: hidden;
      height: 100%;
      cursor: pointer;
    }
    
    [data-theme="dark"] .card {
      background: #2a2a2a;
      color: var(--fedex-dark-gray);
    }
    
    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 4px;
      background: linear-gradient(90deg, var(--fedex-purple), var(--fedex-orange));
    }
    
    .card:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-medium);
    }
    
    .card-icon {
      width: 60px;
      height: 60px;
      background: linear-gradient(45deg, var(--fedex-purple), var(--fedex-orange));
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-bottom: 20px;
      color: white;
      font-size: 24px;
    }
    
    .card h3 {
      color: var(--fedex-purple);
      margin-bottom: 15px;
      font-size: clamp(18px, 2.5vw, 22px);
    }
    
    .card p {
      color: var(--fedex-gray);
      margin-bottom: 20px;
      line-height: 1.6;
      font-size: 15px;
    }
    
    /* Form Styles */
    .form-group {
      margin-bottom: 20px;
    }
    
    .form-label {
      display: block;
      margin-bottom: 8px;
      font-weight: 600;
      color: var(--fedex-purple);
      font-size: 14px;
    }
    
    .form-input,
    .form-select,
    .form-textarea {
      width: 100%;
      padding: 16px;
      border: 2px solid #ddd;
      border-radius: var(--border-radius);
      font-size: 16px;
      transition: var(--transition);
      background: white;
      color: var(--fedex-dark-gray);
      min-height: 48px;
    }
    
    [data-theme="dark"] .form-input,
    [data-theme="dark"] .form-select,
    [data-theme="dark"] .form-textarea {
      background: #3a3a3a;
      border-color: #555;
      color: var(--fedex-dark-gray);
    }
    
    .form-input:focus,
    .form-select:focus,
    .form-textarea:focus {
      outline: none;
      border-color: var(--fedex-purple);
      box-shadow: 0 0 0 3px rgba(77, 20, 140, 0.1);
    }
    
    .form-input.invalid {
      border-color: var(--fedex-red);
      box-shadow: 0 0 0 3px rgba(220, 38, 38, 0.1);
    }
    
    .form-textarea {
      resize: vertical;
      min-height: 120px;
      font-family: inherit;
    }
    
    .error-message {
      color: var(--fedex-red);
      font-size: 14px;
      margin-top: 8px;
      display: none;
    }
    
    .error-message.show {
      display: block;
    }
    
    /* Modal Styles */
    .modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0,0,0,0.8);
      display: none;
      align-items: center;
      justify-content: center;
      z-index: 10000;
      padding: 16px;
    }
    
    .modal.show {
      display: flex;
    }
    
    .modal-content {
      background: white;
      border-radius: 16px;
      width: 100%;
      max-width: 1000px;
      max-height: 90vh;
      overflow-y: auto;
      box-shadow: 0 20px 60px rgba(0,0,0,0.3);
      position: relative;
    }
    
    [data-theme="dark"] .modal-content {
      background: #2a2a2a;
    }
    
    .modal-header {
      background: linear-gradient(135deg, var(--fedex-purple), #662d91);
      color: white;
      padding: 24px;
      border-radius: 16px 16px 0 0;
      display: flex;
      justify-content: space-between;
      align-items: center;
      flex-wrap: wrap;
      gap: 16px;
    }
    
    .modal-header h2 {
      font-size: clamp(20px, 3vw, 24px);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .close-btn {
      background: none;
      border: none;
      color: white;
      font-size: 24px;
      cursor: pointer;
      padding: 8px;
      border-radius: 50%;
      transition: var(--transition);
      min-height: 48px;
      min-width: 48px;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    
    .close-btn:hover {
      background: rgba(255,255,255,0.2);
    }
    
    .modal-body {
      padding: clamp(16px, 4vw, 30px);
    }
    
    /* Package Info Grid */
    .package-info {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 20px;
      margin-bottom: 30px;
    }
    
    .info-card {
      background: var(--fedex-light-gray);
      padding: 20px;
      border-radius: 12px;
      border-left: 4px solid var(--fedex-orange);
    }
    
    .info-card h4 {
      color: var(--fedex-purple);
      margin-bottom: 15px;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-weight: 600;
    }
    
    .info-card .value {
      font-weight: 600;
      color: var(--fedex-dark-gray);
      font-size: 16px;
    }
    
    .status-badge {
      display: inline-block;
      padding: 8px 16px;
      border-radius: 20px;
      font-weight: 600;
      text-transform: uppercase;
      font-size: 12px;
      letter-spacing: 1px;
      background: #d1fae5;
      color: #065f46;
    }
    
    .status-badge.exception {
      background: #fee2e2;
      color: #dc2626;
    }
    
    /* 3D Map Container */
    .map-3d-container {
      height: clamp(250px, 50vw, 400px);
      background: #f8fafc;
      border-radius: 12px;
      margin: 30px 0;
      position: relative;
      overflow: hidden;
      border: 1px solid #e2e8f0;
    }
    
    .map-fallback {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      color: white;
      font-size: clamp(16px, 2.5vw, 18px);
      text-align: center;
      flex-direction: column;
      gap: 16px;
      padding: 20px;
    }
    
    /* Progress Bar */
    .progress-container {
      position: absolute;
      top: 10px;
      right: 10px;
      background: rgba(255,255,255,0.95);
      padding: 12px 16px;
      border-radius: 8px;
      box-shadow: var(--shadow-light);
      z-index: 20;
      min-width: clamp(180px, 25vw, 200px);
    }
    
    .progress-label {
      font-size: 12px;
      color: var(--fedex-purple);
      margin-bottom: 8px;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 1px;
    }
    
    .progress-bar {
      width: 100%;
      height: 8px;
      background: #e2e8f0;
      border-radius: 4px;
      overflow: hidden;
      position: relative;
    }
    
    .progress-fill {
      height: 100%;
      background: linear-gradient(90deg, var(--fedex-purple), var(--fedex-orange));
      border-radius: 4px;
      width: 0%;
      transition: width 1s ease-in-out;
      position: relative;
    }
    
    .progress-text {
      font-size: 10px;
      color: var(--fedex-gray);
      margin-top: 4px;
      text-align: center;
    }
    
    /* Timeline */
    .timeline-container {
      margin-top: 30px;
    }
    
    .timeline-header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      flex-wrap: wrap;
      gap: 16px;
      margin-bottom: 30px;
      padding-bottom: 15px;
      border-bottom: 2px solid var(--fedex-light-gray);
    }
    
    .timeline-header h3 {
      color: var(--fedex-purple);
      font-size: clamp(18px, 3vw, 22px);
      display: flex;
      align-items: center;
      gap: 8px;
    }
    
    .timeline {
      position: relative;
      padding-left: 30px;
    }
    
    .timeline::before {
      content: '';
      position: absolute;
      left: 15px;
      top: 0;
      bottom: 0;
      width: 2px;
      background: linear-gradient(180deg, var(--fedex-purple), var(--fedex-orange));
    }
    
    .timeline-item {
      position: relative;
      margin-bottom: 24px;
      background: white;
      border-radius: 12px;
      padding: 20px;
      box-shadow: var(--shadow-light);
      transition: var(--transition);
    }
    
    [data-theme="dark"] .timeline-item {
      background: #3a3a3a;
    }
    
    .timeline-item:hover {
      transform: translateX(8px);
      box-shadow: var(--shadow-medium);
    }
    
    .timeline-item::before {
      content: '';
      position: absolute;
      left: -37px;
      top: 25px;
      width: 14px;
      height: 14px;
      border-radius: 50%;
      background: var(--fedex-orange);
      border: 3px solid white;
      box-shadow: 0 0 0 2px var(--fedex-orange);
    }
    
    .timeline-item.completed::before {
      background: var(--fedex-green);
      box-shadow: 0 0 0 2px var(--fedex-green);
    }
    
    .timeline-date {
      color: var(--fedex-purple);
      font-weight: 600;
      font-size: 14px;
      text-transform: uppercase;
      letter-spacing: 1px;
      margin-bottom: 8px;
    }
    
    .timeline-title {
      color: var(--fedex-dark-gray);
      font-weight: 600;
      font-size: 16px;
      margin-bottom: 4px;
    }
    
    .timeline-location {
      color: var(--fedex-gray);
      font-size: 14px;
    }
    
    /* Notification Toast */
    .notification-toast {
      position: fixed;
      top: 20px;
      right: 20px;
      background: white;
      border-radius: 12px;
      padding: 16px 20px;
      box-shadow: var(--shadow-medium);
      border-left: 4px solid var(--fedex-orange);
      z-index: 10001;
      transform: translateX(100%);
      transition: transform 0.3s ease;
      max-width: 350px;
      min-width: 280px;
    }
    
    [data-theme="dark"] .notification-toast {
      background: #2a2a2a;
      color: var(--fedex-dark-gray);
    }
    
    .notification-toast.show {
      transform: translateX(0);
    }
    
    .toast-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 8px;
    }
    
    .toast-title {
      font-weight: 600;
      color: var(--fedex-purple);
      font-size: 14px;
    }
    
    .toast-message {
      color: var(--fedex-gray);
      font-size: 13px;
      line-height: 1.4;
    }
    
    /* Footer */
    .footer {
      background: var(--fedex-dark-gray);
      color: white;
      padding: clamp(40px, 6vw, 60px) 0 30px;
    }
    
    .footer-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
      gap: 30px;
      margin-bottom: 30px;
    }
    
    .footer-section h4 {
      color: var(--fedex-orange);
      margin-bottom: 20px;
      font-size: 18px;
    }
    
    .footer-section ul {
      list-style: none;
    }
    
    .footer-section ul li {
      margin-bottom: 12px;
    }
    
    .footer-section ul li a {
      color: #ccc;
      text-decoration: none;
      transition: var(--transition);
      cursor: pointer;
      display: inline-block;
      padding: 4px 0;
    }
    
    .footer-section ul li a:hover {
      color: var(--fedex-orange);
    }
    
    .footer-bottom {
      border-top: 1px solid #555;
      padding-top: 30px;
      text-align: center;
      color: #ccc;
      font-size: 14px;
    }
    
    /* Loading States */
    .loading-spinner {
      border: 3px solid #f3f3f3;
      border-top: 3px solid var(--fedex-purple);
      border-radius: 50%;
      width: 40px;
      height: 40px;
      animation: spin 1s linear infinite;
      margin: 20px auto;
    }
    
    .success-message {
      background: #d1fae5;
      color: #065f46;
      padding: 16px;
      border-radius: var(--border-radius);
      margin: 20px 0;
      border-left: 4px solid var(--fedex-green);
    }
    
    .error-state {
      background: #fee2e2;
      color: var(--fedex-red);
      padding: 20px;
      border-radius: var(--border-radius);
      margin: 20px 0;
      border-left: 4px solid var(--fedex-red);
      text-align: center;
    }
    
    /* Utility Classes */
    .text-center { text-align: center; }
    .flex { display: flex; }
    .flex-center { display: flex; align-items: center; justify-content: center; }
    .flex-between { display: flex; align-items: center; justify-content: space-between; }
    .gap-8 { gap: 8px; }
    .gap-16 { gap: 16px; }
    .mb-16 { margin-bottom: 16px; }
    .mt-16 { margin-top: 16px; }
    .hidden { display: none !important; }
    .sr-only { 
      position: absolute; 
      width: 1px; 
      height: 1px; 
      padding: 0; 
      margin: -1px; 
      overflow: hidden; 
      clip: rect(0,0,0,0); 
      border: 0; 
    }
    
    /* Animations */
    @keyframes spin {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }
    
    @keyframes pulse {
      0%, 100% { opacity: 1; transform: scale(1); }
      50% { opacity: 0.7; transform: scale(1.1); }
    }
    
    @keyframes slideIn {
      from { transform: translateY(20px); opacity: 0; }
      to { transform: translateY(0); opacity: 1; }
    }
    
    /* Responsive Design */
    @media (min-width: 768px) {
      .hero .container {
        grid-template-columns: 1fr 1fr;
        text-align: left;
      }
      
      .nav-main {
        display: flex;
      }
      
      .mobile-menu-btn {
        display: none;
      }
      
      .header-actions {
        flex-wrap: nowrap;
      }
      
      .timeline {
        padding-left: 40px;
      }
      
      .timeline::before {
        left: 20px;
      }
      
      .timeline-item::before {
        left: -47px;
      }
    }
    
    @media (max-width: 767px) {
      .nav-main {
        display: none;
      }
      
      .mobile-menu-btn {
        display: flex;
      }
      
      .hero .container {
        text-align: center;
      }
      
      .hero-actions {
        justify-content: center;
      }
      
      .grid-3,
      .grid-4 {
        grid-template-columns: 1fr;
      }
      
      .package-info {
        grid-template-columns: 1fr;
      }
      
      .modal-content {
        width: 95%;
        margin: 8px;
        max-height: 95vh;
      }
      
      .modal-body {
        padding: 16px;
      }
      
      .timeline-header {
        flex-direction: column;
        align-items: flex-start;
      }
      
      .progress-container {
        position: relative;
        margin-bottom: 16px;
        top: auto;
        right: auto;
        min-width: auto;
      }
      
      .notification-toast {
        top: 10px;
        right: 10px;
        left: 10px;
        max-width: none;
        min-width: auto;
      }
      
      .header-top .container {
        flex-direction: column;
        text-align: center;
        gap: 8px;
      }
      
      .header-main .container {
        flex-wrap: wrap;
      }
      
      .footer-grid {
        grid-template-columns: 1fr;
        gap: 30px;
      }
    }
    
    @media (max-width: 480px) {
      .btn {
        font-size: 14px;
        padding: 12px 16px;
      }
      
      .tracking-widget {
        padding: 16px;
      }
      
      .card {
        padding: 16px;
      }
      
      .content-section {
        padding: 30px 0;
      }
      
      .map-3d-container {
        height: 200px;
      }
    }
    
    /* Focus styles for accessibility */
    *:focus {
      outline: 2px solid var(--fedex-purple);
      outline-offset: 2px;
    }
    
    /* High contrast mode support */
    @media (prefers-contrast: high) {
      .btn-primary {
        border: 2px solid white;
      }
      
      .card {
        border: 1px solid var(--fedex-purple);
      }
    }
    
    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
      }
    }
    
    /* Print styles */
    @media print {
      .header, .footer, .modal, .notification-toast {
        display: none !important;
      }
      
      .page {
        display: block !important;
      }
      
      * {
        background: white !important;
        color: black !important;
      }
    }
  </style>
</head>
<body>
  <header class="header">
    <div class="header-top">
      <div class="container">
        <div>
          <i class="fas fa-phone" aria-hidden="true"></i> 
          <span>1.800.GoFedEx (1.800.463.3339)</span>
        </div>
        <div>
          <a href="#" onclick="showPage('support')" aria-label="Customer Support">Support</a>
          <a href="#" onclick="showPage('help')" aria-label="Help Center" style="margin-left: 20px;">Help</a>
        </div>
      </div>
    </div>
    <div class="header-main">
      <div class="container">
        <a href="#" class="logo" onclick="showPage('home')" aria-label="FedEx Home">
          <span class="logo-text">Fed</span><span class="logo-ex">Ex</span>
        </a>
        <nav aria-label="Main navigation">
          <ul class="nav-main">
            <li><a onclick="showPage('shipping')" tabindex="0" aria-label="Shipping Services">Shipping</a></li>
            <li><a onclick="showPage('tracking')" tabindex="0" aria-label="Track Packages">Tracking</a></li>
            <li><a onclick="showPage('locations')" tabindex="0" aria-label="Find Locations">Locations</a></li>
            <li><a onclick="showPage('support')" tabindex="0" aria-label="Customer Support">Support</a></li>
            <li><a onclick="showPage('manage')" tabindex="0" aria-label="Manage Shipments">Manage</a></li>
          </ul>
        </nav>
        <div class="header-actions">
          <a href="#" class="btn btn-secondary" onclick="showPage('login')" aria-label="Log In to Account">Log In</a>
          <a href="#" class="btn btn-primary" onclick="showPage('signup')" aria-label="Open a New Account">Open Account</a>
          <button class="mobile-menu-btn" onclick="toggleMobileMenu()" aria-label="Toggle Mobile Menu" aria-expanded="false">
            <i class="fas fa-bars" aria-hidden="true"></i>
          </button>
        </div>
        <nav class="mobile-nav" id="mobileNav" aria-label="Mobile navigation">
          <a onclick="showPage('shipping')" aria-label="Shipping Services">Shipping</a>
          <a onclick="showPage('tracking')" aria-label="Track Packages">Tracking</a>
          <a onclick="showPage('locations')" aria-label="Find Locations">Locations</a>
          <a onclick="showPage('support')" aria-label="Customer Support">Support</a>
          <a onclick="showPage('manage')" aria-label="Manage Shipments">Manage</a>
          <a onclick="showPage('login')" aria-label="Log In to Account">Log In</a>
          <a onclick="showPage('signup')" aria-label="Open a New Account">Open Account</a>
        </nav>
      </div>
    </div>
  </header>

  <div class="page-container">
    <!-- Notification Toast -->
    <div class="notification-toast" id="notificationToast" role="alert" aria-live="polite">
      <div class="toast-header">
        <i class="fas fa-info-circle" aria-hidden="true"></i>
        <span class="toast-title" id="toastTitle">Notification</span>
      </div>
      <div class="toast-message" id="toastMessage"></div>
    </div>

    <!-- Home Page -->
    <div class="page active" id="home">
      <section class="hero">
        <div class="container">
          <div class="hero-content">
            <h1>Welcome to the new <span style="color: #FF6200;">FedEx.com</span></h1>
            <p>Shipping and logistics solutions that scale with your business. From small packages to complex supply chains, we deliver what matters most.</p>
            <div class="hero-actions">
              <button class="btn btn-primary" onclick="showPage('services')" aria-label="Explore Shipping Services">
                <i class="fas fa-rocket" aria-hidden="true"></i>
                Explore Services
              </button>
              <button class="btn btn-secondary" onclick="showPage('solutions')" aria-label="Get Business Solutions" style="background: rgba(255,255,255,0.2); border-color: white; color: white;">
                <i class="fas fa-briefcase" aria-hidden="true"></i>
                Get Solutions
              </button>
            </div>
          </div>
          <div class="tracking-widget">
            <h3>
              <i class="fas fa-search" aria-hidden="true"></i> 
              Track Your Shipment
            </h3>
            <form class="tracking-form" id="trackingForm">
              <input 
                type="text" 
                class="form-input" 
                id="trackingInput"
                placeholder="Enter tracking number (e.g., 123456789012)"
                maxlength="12"
                aria-label="Tracking Number Input"
                aria-required="true"
                aria-describedby="trackingError"
                required
                autocomplete="off"
              >
              <button type="submit" class="btn btn-primary" aria-label="Track Shipment">
                <i class="fas fa-search" aria-hidden="true"></i> 
                Track
              </button>
            </form>
            <p class="error-message" id="trackingError" role="alert"></p>
            
            <!-- Demo tracking numbers -->
            <div style="margin-top: 16px; padding: 12px; background: var(--fedex-light-gray); border-radius: 8px;">
              <small style="color: var(--fedex-gray); display: block; margin-bottom: 8px;">Try demo numbers:</small>
              <div style="display: flex; gap: 8px; flex-wrap: wrap;">
                <button type="button" class="btn" style="font-size: 12px; padding: 4px 8px; background: white; color: var(--fedex-purple); border: 1px solid #ddd;" onclick="trackDemo('123456789012')">123456789012</button>
                <button type="button" class="btn" style="font-size: 12px; padding: 4px 8px; background: white; color: var(--fedex-purple); border: 1px solid #ddd;" onclick="trackDemo('987654321098')">987654321098</button>
                <button type="button" class="btn" style="font-size: 12px; padding: 4px 8px; background: white; color: var(--fedex-purple); border: 1px solid #ddd;" onclick="trackDemo('555666777888')">555666777888</button>
              </div>
            </div>
          </div>
        </div>
      </section>
      
      <section class="content-section">
        <div class="container">
          <div class="section-header">
            <h2>Our Services</h2>
            <p>Comprehensive shipping and logistics solutions designed to meet your business needs</p>
          </div>
          <div class="grid grid-3">
            <div class="card" tabindex="0" onclick="showPage('express')" onkeydown="handleKeyPress(event, () => showPage('express'))">
              <div class="card-icon">
                <i class="fas fa-shipping-fast" aria-hidden="true"></i>
              </div>
              <h3>Express Shipping</h3>
              <p>Time-definite delivery with our fastest services. Get your packages delivered by 8 a.m., 10:30 a.m., or end of business day.</p>
              <button class="btn btn-secondary" onclick="showPage('express')" aria-label="Learn More About Express Shipping">Learn More</button>
            </div>
            <div class="card" tabindex="0" onclick="showPage('international')" onkeydown="handleKeyPress(event, () => showPage('international'))">
              <div class="card-icon">
                <i class="fas fa-globe" aria-hidden="true"></i>
              </div>
              <h3>International Shipping</h3>
              <p>Ship to more than 220 countries and territories worldwide with customs expertise and documentation support.</p>
              <button class="btn btn-secondary" onclick="showPage('international')" aria-label="Learn More About International Shipping">Learn More</button>
            </div>
            <div class="card" tabindex="0" onclick="showPage('ground')" onkeydown="handleKeyPress(event, () => showPage('ground'))">
              <div class="card-icon">
                <i class="fas fa-truck" aria-hidden="true"></i>
              </div>
              <h3>Ground Shipping</h3>
              <p>Cost-effective ground delivery for packages and freight within the continental United States.</p>
              <button class="btn btn-secondary" onclick="showPage('ground')" aria-label="Learn More About Ground Shipping">Learn More</button>
            </div>
          </div>
        </div>
      </section>
      
      <section class="content-section gray">
        <div class="container">
          <div class="section-header">
            <h2>Solutions by Business Need</h2>
            <p>Tailored logistics solutions that help your business grow and succeed</p>
          </div>
          <div class="grid grid-4">
            <div class="card" tabindex="0" onclick="showPage('small-business')" onkeydown="handleKeyPress(event, () => showPage('small-business'))">
              <div class="card-icon">
                <i class="fas fa-chart-line" aria-hidden="true"></i>
              </div>
              <h3>Small Business</h3>
              <p>Affordable shipping solutions designed for small and growing businesses</p>
            </div>
            <div class="card" tabindex="0" onclick="showPage('enterprise')" onkeydown="handleKeyPress(event, () => showPage('enterprise'))">
              <div class="card-icon">
                <i class="fas fa-building" aria-hidden="true"></i>
              </div>
              <h3>Enterprise</h3>
              <p>Comprehensive logistics management for large enterprises and corporations</p>
            </div>
            <div class="card" tabindex="0" onclick="showPage('ecommerce')" onkeydown="handleKeyPress(event, () => showPage('ecommerce'))">
              <div class="card-icon">
                <i class="fas fa-shopping-cart" aria-hidden="true"></i>
              </div>
              <h3>E-commerce</h3>
              <p>Integrated shipping solutions for online retailers and marketplaces</p>
            </div>
            <div class="card" tabindex="0" onclick="showPage('healthcare')" onkeydown="handleKeyPress(event, () => showPage('healthcare'))">
              <div class="card-icon">
                <i class="fas fa-heartbeat" aria-hidden="true"></i>
              </div>
              <h3>Healthcare</h3>
              <p>Temperature-controlled and time-sensitive shipping for medical supplies</p>
            </div>
          </div>
        </div>
      </section>
    </div>

    <!-- Shipping Page -->
    <div class="page" id="shipping">
      <div class="content-section">
        <div class="container">
          <div class="section-header">
            <h2>Ship Your Package</h2>
            <p>Create a shipment and get your packages delivered worldwide</p>
          </div>
          <div style="max-width: 800px; margin: 0 auto;">
            <form id="shippingForm" novalidate>
              <div class="grid grid-2" style="margin-bottom: 30px;">
                <div>
                  <h3 style="color: var(--fedex-purple); margin-bottom: 20px;">From</h3>
                  <div class="form-group">
                    <label class="form-label" for="fromName">Full Name *</label>
                    <input type="text" class="form-input" id="fromName" required aria-describedby="fromNameError">
                    <p class="error-message" id="fromNameError" role="alert"></p>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="fromCompany">Company</label>
                    <input type="text" class="form-input" id="fromCompany">
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="fromAddress">Address *</label>
                    <input type="text" class="form-input" id="fromAddress" required aria-describedby="fromAddressError">
                    <p class="error-message" id="fromAddressError" role="alert"></p>
                  </div>
                  <div class="grid grid-2 gap-16">
                    <div class="form-group">
                      <label class="form-label" for="fromCity">City *</label>
                      <input type="text" class="form-input" id="fromCity" required aria-describedby="fromCityError">
                      <p class="error-message" id="fromCityError" role="alert"></p>
                    </div>
                    <div class="form-group">
                      <label class="form-label" for="fromZip">ZIP Code *</label>
                      <input type="text" class="form-input" id="fromZip" required aria-describedby="fromZipError" pattern="[0-9]{5}(-[0-9]{4})?">
                      <p class="error-message" id="fromZipError" role="alert"></p>
                    </div>
                  </div>
                </div>
                <div>
                  <h3 style="color: var(--fedex-purple); margin-bottom: 20px;">To</h3>
                  <div class="form-group">
                    <label class="form-label" for="toName">Full Name *</label>
                    <input type="text" class="form-input" id="toName" required aria-describedby="toNameError">
                    <p class="error-message" id="toNameError" role="alert"></p>
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="toCompany">Company</label>
                    <input type="text" class="form-input" id="toCompany">
                  </div>
                  <div class="form-group">
                    <label class="form-label" for="toAddress">Address *</label>
                    <input type="text" class="form-input" id="toAddress" required aria-describedby="toAddressError">
                    <p class="error-message" id="toAddressError" role="alert"></p>
                  </div>
                  <div class="grid grid-2 gap-16">
                    <div class="form-group">
                      <label class="form-label" for="toCity">City *</label>
                      <input type="text" class="form-input" id="toCity" required aria-describedby="toCityError">
                      <p class="error-message" id="toCityError" role="alert"></p>
                    </div>
                    <div class="form-group">
                      <label class="form-label" for="toZip">ZIP Code *</label>
                      <input type="text" class="form-input" id="toZip" required aria-describedby="toZipError" pattern="[0-9]{5}(-[0-9]{4})?">
                      <p class="error-message" id="toZipError" role="alert"></p>
                    </div>
                  </div>
                </div>
              </div>
              
              <h3 style="color: var(--fedex-purple); margin-bottom: 20px;">Package Details</h3>
              <div class="grid grid-3 gap-16" style="margin-bottom: 30px;">
                <div class="form-group">
                  <label class="form-label" for="serviceType">Service Type *</label>
                  <select class="form-select" id="serviceType" required aria-describedby="serviceTypeError">
                    <option value="">Select Service</option>
                    <option value="express">Express Shipping</option>
                    <option value="ground">Ground Shipping</option>
                    <option value="international">International Shipping</option>
                    <option value="freight">Freight Transport</option>
                  </select>
                  <p class="error-message" id="serviceTypeError" role="alert"></p>
                </div>
                <div class="form-group">
                  <label class="form-label" for="packageType">Package Type *</label>
                  <select class="form-select" id="packageType" required aria-describedby="packageTypeError">
                    <option value="">Select Package</option>
                    <option value="envelope">Envelope</option>
                    <option value="pak">Pak</option>
                    <option value="box">Box</option>
                    <option value="tube">Tube</option>
                    <option value="your-packaging">Your Packaging</option>
                  </select>
                  <p class="error-message" id="packageTypeError" role="alert"></p>
                </div>
                <div class="form-group">
                  <label class="form-label" for="weight">Weight (lbs) *</label>
                  <input type="number" class="form-input" id="weight" step="0.1" min="0.1" required aria-describedby="weightError">
                  <p class="error-message" id="weightError" role="alert"></p>
                </div>
              </div>
              
              <div class="text-center">
                <button type="submit" class="btn btn-primary">
                  <span id="shipmentButtonText">Create Shipment</span>
                </button>
              </div>
            </form>
          </div>
        </div>
      </div>
    </div>

    <!-- Tracking Page -->
    <div class="page" id="tracking">
      <div class="content-section">
        <div class="container">
          <div class="section-header">
            <h2>Track Your Package</h2>
            <p>Enter your tracking number to see the latest status of your shipment</p>
          </div>
          <div style="max-width: 600px; margin: 0 auto;">
            <form id="trackingPageForm">
              <div class="form-group">
                <input 
                  type="text" 
                  class="form-input" 
                  id="trackingPageInput"
                  placeholder="Enter tracking number (e.g., 123456789012)"
                  style="font-size: 18px; padding: 20px; text-align: center;"
                  maxlength="12"
                  aria-label="Tracking Number"
                  required
                  aria-describedby="trackingPageError"
                  autocomplete="off"
                >
                <p class="error-message" id="trackingPageError" role="alert"></p>
              </div>
              <div class="text-center">
                <button type="submit" class="btn btn-primary">
                  <i class="fas fa-search" aria-hidden="true"></i> 
                  Track Package
                </button>
              </div>
            </form>
            
            <!-- Demo tracking examples -->
            <div style="margin-top: 40px; padding: 20px; background: var(--fedex-light-gray); border-radius: 12px;">
              <h4 style="color: var(--fedex-purple); margin-bottom: 16px;">Try Demo Tracking Numbers:</h4>
              <div class="grid grid-3 gap-8">
                <button class="btn btn-secondary" onclick="trackDemo('123456789012')" style="font-size: 14px;">
                  123456789012<br>
                  <small>In Transit</small>
                </button>
                <button class="btn btn-secondary" onclick="trackDemo('987654321098')" style="font-size: 14px;">
                  987654321098<br>
                  <small>Delivered</small>
                </button>
                <button class="btn btn-secondary" onclick="trackDemo('555666777888')" style="font-size: 14px;">
                  555666777888<br>
                  <small>Exception</small>
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Other pages with optimized content -->
    <div class="page" id="locations">
      <div class="content-section">
        <div class="container">
          <div class="section-header">
            <h2>Find FedEx Locations</h2>
            <p>Locate FedEx Office locations, drop boxes, and authorized shipping centers near you</p>
          </div>
          
          <div style="max-width: 600px; margin: 0 auto 40px;">
            <div class="form-group">
              <input type="text" class="form-input" id="locationSearch" placeholder="Enter city, state or ZIP code">
              <button class="btn btn-primary mt-16" onclick="searchLocations()">
                <i class="fas fa-map-marker-alt" aria-hidden="true"></i> 
                Find Locations
              </button>
            </div>
          </div>
          
          <div class="grid grid-3">
            <div class="card">
              <div class="card-icon">
                <i class="fas fa-map-marker-alt" aria-hidden="true"></i>
              </div>
              <h3>FedEx Office - Downtown</h3>
              <p><strong>Address:</strong> 123 Main St, Conway, SC 29526<br>
              <strong>Phone:</strong> (843) 555-1234<br>
              <strong>Services:</strong> Printing, Shipping, Packing</p>
              <p style="color: var(--fedex-green); font-weight: 600;">
                <i class="fas fa-clock" aria-hidden="true"></i> Open 24/7
              </p>
              <div class="flex gap-8 mt-16">
                <button class="btn btn-secondary" onclick="openDirections('123 Main St, Conway, SC 29526')">
                  <i class="fas fa-directions" aria-hidden="true"></i> Directions
                </button>
                <button class="btn btn-secondary" onclick="callLocation('(843) 555-1234')">
                  <i class="fas fa-phone" aria-hidden="true"></i> Call
                </button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-icon">
                <i class="fas fa-store" aria-hidden="true"></i>
              </div>
              <h3>FedEx Ship Center</h3>
              <p><strong>Address:</strong> 456 Industrial Dr, Conway, SC 29526<br>
              <strong>Phone:</strong> (843) 555-5678<br>
              <strong>Services:</strong> Shipping, Ground, Express</p>
              <p style="color: var(--fedex-purple); font-weight: 600;">
                <i class="fas fa-clock" aria-hidden="true"></i> Mon-Fri: 8AM-6PM
              </p>
              <div class="flex gap-8 mt-16">
                <button class="btn btn-secondary" onclick="openDirections('456 Industrial Dr, Conway, SC 29526')">
                  <i class="fas fa-directions" aria-hidden="true"></i> Directions
                </button>
                <button class="btn btn-secondary" onclick="callLocation('(843) 555-5678')">
                  <i class="fas fa-phone" aria-hidden="true"></i> Call
                </button>
              </div>
            </div>
            
            <div class="card">
              <div class="card-icon">
                <i class="fas fa-box" aria-hidden="true"></i>
              </div>
              <h3>FedEx Drop Box</h3>
              <p><strong>Address:</strong> 789 College Rd, Conway, SC 29526<br>
              <strong>Services:</strong> Drop-off only<br>
              <strong>Last Pickup:</strong> 6:00 PM daily</p>
              <p style="color: var(--fedex-orange); font-weight: 600;">
                <i class="fas fa-clock" aria-hidden="true"></i> 24-hour access
              </p>
              <div class="mt-16">
                <button class="btn btn-secondary" onclick="openDirections('789 College Rd, Conway, SC 29526')">
                  <i class="fas fa-directions" aria-hidden="true"></i> Directions
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Support Page -->
    <div class="page" id="support">
      <div class="content-section">
        <div class="container">
          <div class="section-header">
            <h2>Customer Support</h2>
            <p>We're here to help with all your shipping and logistics needs</p>
          </div>
          <div class="grid grid-2" style="max-width: 1000px; margin: 0 auto;">
            <div>
              <h3 style="color: var(--fedex-purple); margin-bottom: 30px;">Contact Us</h3>
              <form id="contactForm" novalidate>
                <div class="form-group">
                  <label class="form-label" for="contactName">Full Name *</label>
                  <input type="text" class="form-input" id="contactName" required aria-describedby="contactNameError">
                  <p class="error-message" id="contactNameError" role="alert"></p>
                </div>
                <div class="form-group">
                  <label class="form-label" for="contactEmail">Email Address *</label>
                  <input type="email" class="form-input" id="contactEmail" required aria-describedby="contactEmailError">
                  <p class="error-message" id="contactEmailError" role="alert"></p>
                </div>
                <div class="form-group">
                  <label class="form-label" for="contactSubject">Subject *</label>
                  <select class="form-select" id="contactSubject" required aria-describedby="contactSubjectError">
                    <option value="">Select a topic</option>
                    <option value="tracking">Tracking Issues</option>
                    <option value="billing">Billing Questions</option>
                    <option value="damaged">Damaged Package</option>
                    <option value="delayed">Delayed Shipment</option>
                    <option value="other">Other</option>
                  </select>
                  <p class="error-message" id="contactSubjectError" role="alert"></p>
                </div>
                <div class="form-group">
                  <label class="form-label" for="contactMessage">Message *</label>
                  <textarea class="form-textarea" id="contactMessage" required aria-describedby="contactMessageError" placeholder="Please describe your issue..."></textarea>
                  <p class="error-message" id="contactMessageError" role="alert"></p>
                </div>
                <button type="submit" class="btn btn-primary">
                  <span id="contactButtonText">Send Message</span>
                </button>
              </form>
            </div>
            
            <div>
              <h3 style="color: var(--fedex-purple); margin-bottom: 30px;">Get Help</h3>
              
              <div class="card mb-16">
                <h4 style="color: var(--fedex-orange); margin-bottom: 10px;">
                  <i class="fas fa-phone" aria-hidden="true"></i> Phone Support
                </h4>
                <p><strong>Customer Service:</strong> 1.800.GoFedEx<br>
                <strong>International:</strong> 1.800.247.4747</p>
                <p style="color: var(--fedex-gray); font-size: 14px;">Available 24/7</p>
                <button class="btn btn-secondary mt-16" onclick="callSupport()">
                  <i class="fas fa-phone" aria-hidden="true"></i> Call Now
                </button>
              </div>
              
              <div class="card mb-16">
                <h4 style="color: var(--fedex-orange); margin-bottom: 10px;">
                  <i class="fas fa-comment" aria-hidden="true"></i> Live Chat
                </h4>
                <p>Chat with customer service representatives</p>
                <p style="color: var(--fedex-gray); font-size: 14px;">Mon-Fri: 8AM-8PM EST</p>
                <button class="btn btn-secondary mt-16" onclick="startLiveChat()">
                  <i class="fas fa-comment" aria-hidden="true"></i> Start Chat
                </button>
              </div>
              
              <div class="card">
                <h4 style="color: var(--fedex-orange); margin-bottom: 10px;">
                  <i class="fas fa-question-circle" aria-hidden="true"></i> FAQs
                </h4>
                <p>Find quick answers to common questions</p>
                <button class="btn btn-secondary mt-16" onclick="showPage('faq')">
                  <i class="fas fa-book" aria-hidden="true"></i> View FAQs
                </button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Login & Signup Pages -->
    <div class="page" id="login">
      <div class="content-section">
        <div class="container">
          <div style="max-width: 400px; margin: 0 auto;">
            <div class="text-center mb-16" style="margin-bottom: 30px;">
              <h2 style="color: var(--fedex-purple);">Sign In</h2>
              <p>Access your FedEx account</p>
            </div>
            <form id="loginForm" novalidate>
              <div class="form-group">
                <label class="form-label" for="loginEmail">Email Address *</label>
                <input type="email" class="form-input" id="loginEmail" required aria-describedby="loginEmailError" autocomplete="email">
                <p class="error-message" id="loginEmailError" role="alert"></p>
              </div>
              <div class="form-group">
                <label class="form-label" for="loginPassword">Password *</label>
                <input type="password" class="form-input" id="loginPassword" required aria-describedby="passwordError" autocomplete="current-password">
                <p class="error-message" id="passwordError" role="alert"></p>
              </div>
              <div class="form-group">
                <label class="flex" style="align-items: center; gap: 8px; cursor: pointer;">
                  <input type="checkbox" id="rememberMe">
                  <span>Remember Me</span>
                </label>
              </div>
              <button type="submit" class="btn btn-primary" style="width: 100%;">
                <span id="loginButtonText">Sign In</span>
              </button>
              <div class="text-center mt-16">
                <a href="#" onclick="showPage('forgot-password')" style="color: var(--fedex-purple);">Forgot Password?</a>
              </div>
            </form>
            <div class="text-center mt-16" style="padding-top: 20px; border-top: 1px solid #ddd;">
              <p>New to FedEx?</p>
              <button class="btn btn-secondary mt-16" onclick="showPage('signup')">Create Account</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <div class="page" id="signup">
      <div class="content-section">
        <div class="container">
          <div style="max-width: 600px; margin: 0 auto;">
            <div class="text-center mb-16" style="margin-bottom: 30px;">
              <h2 style="color: var(--fedex-purple);">Create Account</h2>
              <p>Start shipping with FedEx today</p>
            </div>
            <form id="signupForm" novalidate>
              <div class="grid grid-2 gap-16">
                <div class="form-group">
                  <label class="form-label" for="firstName">First Name *</label>
                  <input type="text" class="form-input" id="firstName" required aria-describedby="firstNameError" autocomplete="given-name">
                  <p class="error-message" id="firstNameError" role="alert"></p>
                </div>
                <div class="form-group">
                  <label class="form-label" for="lastName">Last Name *</label>
                  <input type="text" class="form-input" id="lastName" required aria-describedby="lastNameError" autocomplete="family-name">
                  <p class="error-message" id="lastNameError" role="alert"></p>
                </div>
              </div>
              <div class="form-group">
                <label class="form-label" for="signupEmail">Email Address *</label>
                <input type="email" class="form-input" id="signupEmail" required aria-describedby="signupEmailError" autocomplete="email">
                <p class="error-message" id="signupEmailError" role="alert"></p>
              </div>
              <div class="form-group">
                <label class="form-label" for="signupPassword">Password * (8+ characters)</label>
                <input type="password" class="form-input" id="signupPassword" required aria-describedby="signupPasswordError" autocomplete="new-password" minlength="8">
                <p class="error-message" id="signupPasswordError" role="alert"></p>
              </div>
              <div class="form-group">
                <label class="form-label" for="confirmPassword">Confirm Password *</label>
                <input type="password" class="form-input" id="confirmPassword" required aria-describedby="confirmPasswordError" autocomplete="new-password">
                <p class="error-message" id="confirmPasswordError" role="alert"></p>
              </div>
              <div class="form-group">
                <label class="flex" style="align-items: flex-start; gap: 8px; cursor: pointer;">
                  <input type="checkbox" id="termsAgree" required aria-describedby="termsCheck" style="margin-top: 4px;">
                  <span>I agree to the <a href="#" onclick="showPage('terms')" style="color: var(--fedex-purple);">Terms and Conditions</a></span>
                </label>
                <p class="error-message" id="termsCheck" role="alert"></p>
              </div>
              <button type="submit" class="btn btn-primary" style="width: 100%;">
                <span id="signupButtonText">Create Account</span>
              </button>
            </form>
            <div class="text-center mt-16" style="padding-top: 20px; border-top: 1px solid #ddd;">
              <p>Already have an account?</p>
              <button class="btn btn-secondary mt-16" onclick="showPage('login')">Sign In</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Manage Page -->
    <div class="page" id="manage">
      <div class="content-section">
        <div class="container">
          <div class="section-header">
            <h2>Manage Your Shipments</h2>
            <p>Track, update, or cancel your FedEx shipments</p>
          </div>
          <div class="text-center" style="margin-top: 60px;">
            <div class="card" style="max-width: 500px; margin: 0 auto; text-align: center;">
              <i class="fas fa-lock" style="font-size: 48px; color: var(--fedex-purple); margin-bottom: 20px;" aria-hidden="true"></i>
              <h3 style="color: var(--fedex-purple); margin-bottom: 20px;">Sign In Required</h3>
              <p style="margin-bottom: 30px;">Please sign in to view and manage your shipments.</p>
              <div class="flex gap-16" style="justify-content: center; flex-wrap: wrap;">
                <button class="btn btn-primary" onclick="showPage('login')">Sign In</button>
                <button class="btn btn-secondary" onclick="showPage('signup')">Create Account</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Enhanced Tracking Modal -->
    <div class="modal" id="trackingModal" aria-hidden="true" role="dialog" aria-labelledby="modalTitle">
      <div class="modal-content">
        <div class="modal-header">
          <h2 id="modalTitle">
            <i class="fas fa-box" aria-hidden="true"></i> 
            Shipment Tracking
          </h2>
          <button class="close-btn" onclick="closeModal()" aria-label="Close Modal">
            <i class="fas fa-times" aria-hidden="true"></i>
          </button>
        </div>
        <div class="modal-body" id="modalBody">
          <div class="flex-center">
            <div class="loading-spinner"></div>
          </div>
          <p class="text-center">Loading shipment details...</p>
        </div>
      </div>
    </div>
  </div>

  <footer class="footer">
    <div class="container">
      <div class="footer-grid">
        <div class="footer-section">
          <h4>Services</h4>
          <ul>
            <li><a onclick="showPage('express')" aria-label="Express Shipping">Express Shipping</a></li>
            <li><a onclick="showPage('ground')" aria-label="Ground Shipping">Ground Shipping</a></li>
            <li><a onclick="showPage('international')" aria-label="International Shipping">International Shipping</a></li>
            <li><a onclick="showPage('freight')" aria-label="Freight Services">Freight Services</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Support</h4>
          <ul>
            <li><a onclick="showPage('support')" aria-label="Customer Support">Customer Support</a></li>
            <li><a onclick="showPage('faq')" aria-label="Frequently Asked Questions">FAQs</a></li>
            <li><a onclick="showPage('locations')" aria-label="Find Locations">Find Locations</a></li>
            <li><a href="tel:+18004633339" aria-label="Call Support">1.800.463.3339</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Company</h4>
          <ul>
            <li><a onclick="showPage('about')" aria-label="About FedEx">About FedEx</a></li>
            <li><a onclick="showPage('careers')" aria-label="Careers at FedEx">Careers</a></li>
            <li><a onclick="showPage('sustainability')" aria-label="Sustainability">Sustainability</a></li>
            <li><a onclick="showPage('investors')" aria-label="Investor Relations">Investor Relations</a></li>
          </ul>
        </div>
        <div class="footer-section">
          <h4>Legal</h4>
          <ul>
            <li><a onclick="showPage('terms')" aria-label="Terms of Service">Terms of Service</a></li>
            <li><a onclick="showPage('privacy')" aria-label="Privacy Policy">Privacy Policy</a></li>
            <li><a onclick="showPage('cookies')" aria-label="Cookie Policy">Cookie Policy</a></li>
          </ul>
        </div>
      </div>
      <div class="footer-bottom">
        <p>&copy; 2025 FedEx Corporation. All rights reserved.</p>
      </div>
    </div>
  </footer>

  <script>
    // Application State and Configuration
    const AppState = {
      currentPage: 'home',
      currentTrackingData: null,
      trackingUpdateInterval: null,
      scene: null,
      camera: null,
      renderer: null,
      animationFrameId: null
    };

    const Config = {
      updateInterval: 30000, // 30 seconds
      animationFrameRate: 30, // 30fps for better mobile performance
      notificationDuration: 5000, // 5 seconds
      pageNames: {
        'investors': 'Investor Relations',
        'careers': 'Careers', 
        'sustainability': 'Sustainability',
        'faq': 'Frequently Asked Questions',
        'terms': 'Terms of Service',
        'privacy': 'Privacy Policy',
        'cookies': 'Cookie Policy',
        'freight': 'Freight Services',
        'services': 'Services Overview',
        'solutions': 'Business Solutions',
        'forgot-password': 'Forgot Password',
        'small-business': 'Small Business Solutions',
        'enterprise': 'Enterprise Solutions',
        'ecommerce': 'E-commerce Solutions',
        'healthcare': 'Healthcare Solutions',
        'help': 'Help Center',
        'express': 'Express Shipping',
        'ground': 'Ground Shipping',
        'international': 'International Shipping',
        'about': 'About FedEx'
      }
    };

    // Mock data for testing
    const MockData = {
      tracking: {
        '123456789012': {
          trackingNumber: '123456789012',
          status: 'In Transit',
          origin: 'New York, NY',
          destination: 'Los Angeles, CA',
          currentLocation: 'Chicago, IL',
          estimatedDelivery: '2025-01-22',
          actualDelivery: null,
          weight: '5.2 lbs',
          serviceType: 'FedEx Express',
          packageType: 'Box',
          progress: 65,
          history: [
            { date: '2025-01-18 09:00 AM', status: 'Picked up', location: 'New York, NY', completed: true },
            { date: '2025-01-19 02:15 PM', status: 'In Transit', location: 'Chicago, IL', completed: true },
            { date: '2025-01-20 06:00 AM', status: 'In Transit', location: 'Denver, CO', completed: false }
          ]
        },
        '987654321098': {
          trackingNumber: '987654321098',
          status: 'Delivered',
          origin: 'Seattle, WA',
          destination: 'Miami, FL',
          currentLocation: 'Miami, FL',
          estimatedDelivery: '2025-01-19',
          actualDelivery: '2025-01-19 02:45 PM',
          weight: '12.8 lbs',
          serviceType: 'FedEx Ground',
          packageType: 'Box',
          progress: 100,
          history: [
            { date: '2025-01-15 10:30 AM', status: 'Picked up', location: 'Seattle, WA', completed: true },
            { date: '2025-01-16 08:15 AM', status: 'In Transit', location: 'Salt Lake City, UT', completed: true },
            { date: '2025-01-19 02:45 PM', status: 'Delivered', location: 'Miami, FL', completed: true }
          ]
        },
        '555666777888': {
          trackingNumber: '555666777888',
          status: 'Exception',
          origin: 'Boston, MA',
          destination: 'Phoenix, AZ',
          currentLocation: 'Memphis, TN',
          estimatedDelivery: '2025-01-21',
          actualDelivery: null,
          weight: '3.1 lbs',
          serviceType: 'FedEx Priority Overnight',
          packageType: 'Envelope',
          progress: 45,
          exception: 'Weather delay',
          history: [
            { date: '2025-01-18 02:00 PM', status: 'Picked up', location: 'Boston, MA', completed: true },
            { date: '2025-01-20 08:00 AM', status: 'Exception - Weather delay', location: 'Memphis, TN', completed: true }
          ]
        }
      }
    };

    // Utility Functions
    const Utils = {
      // Dark mode detection
      initDarkMode() {
        const prefersDark = window.matchMedia('(prefers-color-scheme: dark)').matches;
        document.documentElement.setAttribute('data-theme', prefersDark ? 'dark' : 'light');
        
        window.matchMedia('(prefers-color-scheme: dark)').addEventListener('change', e => {
          document.documentElement.setAttribute('data-theme', e.matches ? 'dark' : 'light');
        });
      },

      // Validation functions
      validateTrackingNumber: (number) => /^[0-9]{12}$/.test(number),
      validateEmail: (email) => /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(email),
      validateZipCode: (zip) => /^[0-9]{5}(-[0-9]{4})?$/.test(zip),
      validatePhone: (phone) => /^[\(\)\-\s\d]{10,}$/.test(phone),

      // Error handling
      showError(inputId, errorId, message) {
        const input = document.getElementById(inputId);
        const error = document.getElementById(errorId);
        if (input && error) {
          input.classList.add('invalid');
          error.textContent = message;
          error.classList.add('show');
          input.setAttribute('aria-invalid', 'true');
        }
      },

      clearError(inputId, errorId) {
        const input = document.getElementById(inputId);
        const error = document.getElementById(errorId);
        if (input && error) {
          input.classList.remove('invalid');
          error.textContent = '';
          error.classList.remove('show');
          input.setAttribute('aria-invalid', 'false');
        }
      },

      clearAllErrors(form) {
        const inputs = form.querySelectorAll('.form-input, .form-select, .form-textarea');
        const errors = form.querySelectorAll('.error-message');
        
        inputs.forEach(input => {
          input.classList.remove('invalid');
          input.setAttribute('aria-invalid', 'false');
        });
        
        errors.forEach(error => {
          error.textContent = '';
          error.classList.remove('show');
        });
      },

      // Performance optimized debounce
      debounce(func, wait) {
        let timeout;
        return function executedFunction(...args) {
          const later = () => {
            clearTimeout(timeout);
            func(...args);
          };
          clearTimeout(timeout);
          timeout = setTimeout(later, wait);
        };
      },

      // Keyboard event handler
      handleKeyPress(event, callback) {
        if (event.key === 'Enter' || event.key === ' ') {
          event.preventDefault();
          callback();
        }
      }
    };

    // Notification System
    const Notifications = {
      show(title, message, type = 'info') {
        const toast = document.getElementById('notificationToast');
        const titleEl = document.getElementById('toastTitle');
        const messageEl = document.getElementById('toastMessage');
        const iconEl = toast.querySelector('.fas');
        
        titleEl.textContent = title;
        messageEl.textContent = message;
        
        // Update icon and styling based on type
        iconEl.className = 'fas';
        switch(type) {
          case 'success':
            iconEl.classList.add('fa-check-circle');
            toast.style.borderLeftColor = 'var(--fedex-green)';
            break;
          case 'error':
            iconEl.classList.add('fa-exclamation-triangle');
            toast.style.borderLeftColor = 'var(--fedex-red)';
            break;
          case 'warning':
            iconEl.classList.add('fa-exclamation-circle');
            toast.style.borderLeftColor = '#fbbf24';
            break;
          default:
            iconEl.classList.add('fa-info-circle');
            toast.style.borderLeftColor = 'var(--fedex-orange)';
        }
        
        toast.classList.add('show');
        
        // Auto-hide notification
        setTimeout(() => {
          toast.classList.remove('show');
        }, Config.notificationDuration);
      }
    };

    // Navigation System
    const Navigation = {
      showPage(pageId) {
        // Update state
        AppState.currentPage = pageId;
        
        // Hide all pages
        document.querySelectorAll('.page').forEach(page => page.classList.remove('active'));
        
        // Get or create page element
        let pageElement = document.getElementById(pageId);
        if (!pageElement) {
          pageElement = this.createPlaceholderPage(pageId);
          document.querySelector('.page-container').appendChild(pageElement);
        }
        
        // Show selected page
        pageElement.classList.add('active');

        // Update navigation active states
        document.querySelectorAll('.nav-main a, .mobile-nav a').forEach(a => {
          a.classList.toggle('active', a.getAttribute('onclick')?.includes(`'${pageId}'`));
        });

        // Close mobile menu
        document.getElementById('mobileNav').classList.remove('active');
        document.querySelector('.mobile-menu-btn').setAttribute('aria-expanded', 'false');
        
        // Scroll to top with smooth behavior
        window.scrollTo({ top: 0, behavior: 'smooth' });
        
        // Update page title
        const title = Config.pageNames[pageId] || pageId.charAt(0).toUpperCase() + pageId.slice(1);
        document.title = `${title} - FedEx`;
        
        // Clean up resources if switching away from tracking
        if (pageId !== 'tracking') {
          TrackingSystem.cleanup();
        }
      },

      createPlaceholderPage(pageId) {
        const page = document.createElement('div');
        page.className = 'page';
        page.id = pageId;
        
        const title = Config.pageNames[pageId] || pageId.charAt(0).toUpperCase() + pageId.slice(1);
        page.innerHTML = `
          <div class="content-section">
            <div class="container">
              <div class="section-header">
                <h2>${title}</h2>
                <p>This section is under development. Please check back later for updates.</p>
              </div>
              <div class="text-center">
                <button class="btn btn-primary" onclick="showPage('home')">
                  <i class="fas fa-home" aria-hidden="true"></i> Back to Home
                </button>
              </div>
            </div>
          </div>
        `;
        
        return page;
      },

      toggleMobileMenu() {
        const mobileNav = document.getElementById('mobileNav');
        const isActive = mobileNav.classList.toggle('active');
        const menuBtn = document.querySelector('.mobile-menu-btn');
        menuBtn.setAttribute('aria-expanded', isActive);
      }
    };

    // Enhanced Tracking System
    const TrackingSystem = {
      async mockTrackingAPI(trackingNumber) {
        return new Promise((resolve, reject) => {
          setTimeout(() => {
            const data = MockData.tracking[trackingNumber];
            if (data) {
              // Simulate real-time updates for in-transit packages
              if (data.status === 'In Transit' && trackingNumber === '123456789012') {
                const now = new Date();
                const lastUpdate = new Date(data.history[data.history.length - 1].date);
                const timeDiff = now - lastUpdate;
                
                // Add new update if more than 2 minutes since initialization
                if (timeDiff > 120000 && Math.random() > 0.7) {
                  data.history.push({
                    date: now.toLocaleString(),
                    status: 'In Transit',
                    location: 'Denver, CO',
                    completed: true
                  });
                  data.currentLocation = 'Denver, CO';
                  data.progress = 80;
                }
              }
              resolve(JSON.parse(JSON.stringify(data))); // Deep clone
            } else {
              reject(new Error('Tracking number not found. Please check your tracking number and try again.'));
            }
          }, Math.random() * 800 + 200); // Random delay 200-1000ms
        });
      },

      async showTrackingModal(trackingNumber) {
        const modal = document.getElementById('trackingModal');
        const modalBody = document.getElementById('modalBody');
        
        // Show loading state
        modalBody.innerHTML = `
          <div class="flex-center">
            <div class="loading-spinner"></div>
          </div>
          <p class="text-center">Loading shipment details...</p>
        `;

        modal.classList.add('show');
        modal.setAttribute('aria-hidden', 'false');

        try {
          const data = await this.mockTrackingAPI(trackingNumber);
          AppState.currentTrackingData = data;
          
          modalBody.innerHTML = this.generateTrackingHTML(data);
          
          // Initialize 3D map after content is loaded
          setTimeout(() => {
            this.init3DMap();
          }, 100);
          
          // Start real-time updates for in-transit packages
          if (data.status === 'In Transit') {
            this.startTrackingUpdates(trackingNumber);
          }

        } catch (error) {
          modalBody.innerHTML = `
            <div class="error-state">
              <h3><i class="fas fa-exclamation-triangle" aria-hidden="true"></i> Tracking Error</h3>
              <p>${error.message}</p>
              <div class="flex gap-16" style="justify-content: center; margin-top: 20px;">
                <button class="btn btn-primary" onclick="closeModal()">Close</button>
                <button class="btn btn-secondary" onclick="showTrackingModal('${trackingNumber}')">Try Again</button>
              </div>
            </div>
          `;
        }
      },

      generateTrackingHTML(data) {
        const statusClass = data.status === 'Delivered' ? 'delivered' : 
                           data.status === 'Exception' ? 'exception' : '';

        return `
          <div class="progress-container">
            <div class="progress-label">Delivery Progress</div>
            <div class="progress-bar">
              <div class="progress-fill" style="width: ${data.progress}%"></div>
            </div>
            <div class="progress-text">${data.progress}% Complete - ${data.status}</div>
          </div>

          <div class="package-info">
            <div class="info-card">
              <h4>Tracking Number</h4>
              <p class="value">${data.trackingNumber}</p>
            </div>
            <div class="info-card">
              <h4>Status</h4>
              <p class="value">
                <span class="status-badge ${statusClass}">${data.status}</span>
                ${data.exception ? `<br><small style="color: var(--fedex-red);">⚠️ ${data.exception}</small>` : ''}
              </p>
            </div>
            <div class="info-card">
              <h4>Origin</h4>
              <p class="value">${data.origin}</p>
            </div>
            <div class="info-card">
              <h4>Current Location</h4>
              <p class="value">${data.currentLocation}</p>
            </div>
            <div class="info-card">
              <h4>Destination</h4>
              <p class="value">${data.destination}</p>
            </div>
            <div class="info-card">
              <h4>${data.actualDelivery ? 'Delivered' : 'Estimated Delivery'}</h4>
              <p class="value">${data.actualDelivery || data.estimatedDelivery}</p>
            </div>
            <div class="info-card">
              <h4>Weight</h4>
              <p class="value">${data.weight}</p>
            </div>
            <div class="info-card">
              <h4>Service Type</h4>
              <p class="value">${data.serviceType}</p>
            </div>
          </div>
          
          <div class="map-3d-container" id="map3D">
            <div class="map-fallback">
              <i class="fas fa-map-marked-alt" style="font-size: 48px; margin-bottom: 16px;"></i>
              <p>Initializing 3D tracking map...</p>
              <div style="margin-top: 16px;">
                <div style="display: inline-block; width: 12px; height: 12px; background: var(--fedex-purple); border-radius: 50%; margin: 0 8px;"></div>
                <span style="font-size: 14px;">━━━</span>
                <div style="display: inline-block; width: 12px; height: 12px; background: var(--fedex-orange); border-radius: 50%; margin: 0 8px;"></div>
                <span style="font-size: 14px;">━━━</span>
                <div style="display: inline-block; width: 12px; height: 12px; background: var(--fedex-green); border-radius: 50%; margin: 0 8px;"></div>
              </div>
            </div>
          </div>
          
          <div class="timeline-container">
            <div class="timeline-header">
              <h3><i class="fas fa-history" aria-hidden="true"></i> Tracking History</h3>
              <button class="btn btn-secondary" onclick="generateTrackingPDF()">
                <i class="fas fa-download" aria-hidden="true"></i> Download PDF
              </button>
            </div>
            <div class="timeline">
              ${data.history.map(event => `
                <div class="timeline-item ${event.completed ? 'completed' : ''}">
                  <div class="timeline-date">${event.date}</div>
                  <div class="timeline-title">${event.status}</div>
                  <div class="timeline-location">${event.location}</div>
                </div>
              `).join('')}
            </div>
          </div>
        `;
      },

      init3DMap() {
        const container = document.getElementById('map3D');
        if (!container || !window.THREE) {
          return;
        }

        try {
          this.cleanup3D();

          AppState.scene = new THREE.Scene();
          AppState.camera = new THREE.PerspectiveCamera(75, container.clientWidth / container.clientHeight, 0.1, 1000);
          AppState.renderer = new THREE.WebGLRenderer({ 
            antialias: true, 
            alpha: true,
            powerPreference: "low-power"
          });
          
          AppState.renderer.setSize(container.clientWidth, container.clientHeight);
          AppState.renderer.setClearColor(0x667eea, 1);
          container.appendChild(AppState.renderer.domElement);

          // Create enhanced map elements
          this.createMapElements();
          
          AppState.camera.position.set(0, 0, 8);
          AppState.camera.lookAt(0, 0, 0);

          // Start optimized animation loop
          this.startAnimation();

          // Handle window resize
          const handleResize = Utils.debounce(() => {
            if (AppState.camera && AppState.renderer && container) {
              AppState.camera.aspect = container.clientWidth / container.clientHeight;
              AppState.camera.updateProjectionMatrix();
              AppState.renderer.setSize(container.clientWidth, container.clientHeight);
            }
          }, 250);
          
          window.addEventListener('resize', handleResize);
          AppState.renderer.userData = { handleResize };

        } catch (error) {
          console.error('3D Map initialization failed:', error);
          this.showMapFallback(container);
        }
      },

      createMapElements() {
        // Create map plane
        const geometry = new THREE.PlaneGeometry(10, 10, 16, 16);
        const material = new THREE.MeshBasicMaterial({
          color: 0x4472c4,
          transparent: true,
          opacity: 0.8,
          wireframe: true
        });
        const plane = new THREE.Mesh(geometry, material);
        AppState.scene.add(plane);

        // Add route markers
        const markerGeometry = new THREE.SphereGeometry(0.15, 8, 8);
        
        // Origin (purple)
        const originMarker = new THREE.Mesh(markerGeometry, 
          new THREE.MeshBasicMaterial({ color: 0x4D148C }));
        originMarker.position.set(-4, 2, 0.2);
        AppState.scene.add(originMarker);

        // Current (orange, animated)
        const currentMarker = new THREE.Mesh(markerGeometry, 
          new THREE.MeshBasicMaterial({ color: 0xFF6200 }));
        currentMarker.position.set(0, 0, 0.2);
        AppState.scene.add(currentMarker);
        AppState.scene.userData.currentMarker = currentMarker;

        // Destination (green)
        const destinationMarker = new THREE.Mesh(markerGeometry, 
          new THREE.MeshBasicMaterial({ color: 0x10b981 }));
        destinationMarker.position.set(4, -2, 0.2);
        AppState.scene.add(destinationMarker);

        // Route line
        const points = [
          new THREE.Vector3(-4, 2, 0.1),
          new THREE.Vector3(0, 0, 0.1),
          new THREE.Vector3(4, -2, 0.1)
        ];
        const routeGeometry = new THREE.BufferGeometry().setFromPoints(points);
        const routeLine = new THREE.Line(routeGeometry, 
          new THREE.LineBasicMaterial({ color: 0xFFFFFF, linewidth: 2 }));
        AppState.scene.add(routeLine);
      },

      startAnimation() {
        let lastTime = 0;
        const targetFPS = Config.animationFrameRate;
        const frameTime = 1000 / targetFPS;
        
        const animate = (currentTime) => {
          AppState.animationFrameId = requestAnimationFrame(animate);
          
          if (currentTime - lastTime < frameTime) return;
          lastTime = currentTime;
          
          // Animate current marker
          const currentMarker = AppState.scene?.userData?.currentMarker;
          if (currentMarker) {
            const scale = 1 + 0.2 * Math.sin(currentTime * 0.003);
            currentMarker.scale.setScalar(scale);
          }
          
          if (AppState.renderer && AppState.scene && AppState.camera) {
            AppState.renderer.render(AppState.scene, AppState.camera);
          }
        };
        
        animate(0);
      },

      showMapFallback(container) {
        if (container) {
          container.innerHTML = `
            <div class="map-fallback">
              <i class="fas fa-map-marked-alt" style="font-size: 48px; margin-bottom: 16px;"></i>
              <p>3D Map View</p>
              <p>Tracking route visualization</p>
            </div>
          `;
        }
      },

      startTrackingUpdates(trackingNumber) {
        if (AppState.trackingUpdateInterval) {
          clearInterval(AppState.trackingUpdateInterval);
        }
        
        AppState.trackingUpdateInterval = setInterval(async () => {
          try {
            const data = await this.mockTrackingAPI(trackingNumber);
            if (data && data.trackingNumber === trackingNumber) {
              // Check for updates
              const hasUpdate = data.history.length > AppState.currentTrackingData?.history.length;
              if (hasUpdate) {
                Notifications.show('Shipment Update', 
                  `Your package location has been updated: ${data.currentLocation}`, 'info');
                AppState.currentTrackingData = data;
                this.updateTrackingDisplay(data);
              }
            }
          } catch (error) {
            console.error('Failed to update tracking:', error);
          }
        }, Config.updateInterval);
      },

      updateTrackingDisplay(data) {
        // Update progress bar
        const progressFill = document.querySelector('.progress-fill');
        const progressText = document.querySelector('.progress-text');
        if (progressFill && progressText) {
          progressFill.style.width = `${data.progress}%`;
          progressText.textContent = `${data.progress}% Complete - ${data.status}`;
        }
        
        // Update current location
        const currentLocationElement = document.querySelector('.info-card:nth-child(4) .value');
        if (currentLocationElement) {
          currentLocationElement.textContent = data.currentLocation;
        }
      },

      cleanup() {
        this.cleanup3D();
        this.stopTrackingUpdates();
        AppState.currentTrackingData = null;
      },

      cleanup3D() {
        if (AppState.animationFrameId) {
          cancelAnimationFrame(AppState.animationFrameId);
          AppState.animationFrameId = null;
        }
        
        if (AppState.renderer) {
          if (AppState.renderer.userData?.handleResize) {
            window.removeEventListener('resize', AppState.renderer.userData.handleResize);
          }
          AppState.renderer.dispose();
          AppState.renderer = null;
        }
        
        if (AppState.scene) {
          AppState.scene.clear();
          AppState.scene = null;
        }
        
        AppState.camera = null;
        
        const container = document.getElementById('map3D');
        if (container) {
          container.innerHTML = '';
        }
      },

      stopTrackingUpdates() {
        if (AppState.trackingUpdateInterval) {
          clearInterval(AppState.trackingUpdateInterval);
          AppState.trackingUpdateInterval = null;
        }
      }
    };

    // Form System
    const FormSystem = {
      setupFormHandlers() {
        // Tracking forms
        this.setupTrackingForms();
        
        // Shipping form
        this.setupShippingForm();
        
        // Login form
        this.setupLoginForm();
        
        // Signup form
        this.setupSignupForm();
        
        // Contact form
        this.setupContactForm();
      },

      setupTrackingForms() {
        const forms = ['trackingForm', 'trackingPageForm'];
        forms.forEach(formId => {
          const form = document.getElementById(formId);
          if (form) {
            form.addEventListener('submit', async (e) => {
              e.preventDefault();
              const input = form.querySelector('input[type="text"]');
              const trackingNumber = input.value.trim();
              const errorId = formId === 'trackingForm' ? 'trackingError' : 'trackingPageError';
              
              if (Utils.validateTrackingNumber(trackingNumber)) {
                Utils.clearError(input.id, errorId);
                input.disabled = true;
                
                try {
                  await TrackingSystem.showTrackingModal(trackingNumber);
                } catch (error) {
                  Utils.showError(input.id, errorId, 'Unable to track package at this time.');
                } finally {
                  input.disabled = false;
                }
              } else {
                Utils.showError(input.id, errorId, 'Please enter a valid 12-digit tracking number.');
              }
            });
          }
        });
      },

      setupShippingForm() {
        const form = document.getElementById('shippingForm');
        if (!form) return;

        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          
          const fields = [
            { id: 'fromName', errorId: 'fromNameError', message: 'Please enter a valid name.', validator: (v) => v.length >= 2 },
            { id: 'fromAddress', errorId: 'fromAddressError', message: 'Please enter a valid address.', validator: (v) => v.length >= 5 },
            { id: 'fromCity', errorId: 'fromCityError', message: 'Please enter a valid city.', validator: (v) => v.length >= 2 },
            { id: 'fromZip', errorId: 'fromZipError', message: 'Please enter a valid ZIP code.', validator: Utils.validateZipCode },
            { id: 'toName', errorId: 'toNameError', message: 'Please enter a valid name.', validator: (v) => v.length >= 2 },
            { id: 'toAddress', errorId: 'toAddressError', message: 'Please enter a valid address.', validator: (v) => v.length >= 5 },
            { id: 'toCity', errorId: 'toCityError', message: 'Please enter a valid city.', validator: (v) => v.length >= 2 },
            { id: 'toZip', errorId: 'toZipError', message: 'Please enter a valid ZIP code.', validator: Utils.validateZipCode },
            { id: 'serviceType', errorId: 'serviceTypeError', message: 'Please select a service type.', validator: (v) => v.length > 0 },
            { id: 'packageType', errorId: 'packageTypeError', message: 'Please select a package type.', validator: (v) => v.length > 0 },
            { id: 'weight', errorId: 'weightError', message: 'Please enter a valid weight (minimum 0.1 lbs).', validator: (v) => parseFloat(v) >= 0.1 }
          ];

          let isValid = true;
          fields.forEach(field => {
            const input = document.getElementById(field.id);
            const value = input.value.trim();
            
            if (!field.validator(value)) {
              Utils.showError(field.id, field.errorId, field.message);
              isValid = false;
            } else {
              Utils.clearError(field.id, field.errorId);
            }
          });

          if (isValid) {
            const button = form.querySelector('button[type="submit"]');
            const buttonText = document.getElementById('shipmentButtonText');
            
            button.disabled = true;
            buttonText.textContent = 'Creating Shipment...';
            
            // Simulate shipment creation
            setTimeout(() => {
              const trackingNumber = '999' + Math.floor(Math.random() * 1000000000).toString().padStart(9, '0');
              
              Notifications.show('Shipment Created', 
                `Tracking number: ${trackingNumber}`, 'success');
              
              form.reset();
              Utils.clearAllErrors(form);
              
              button.disabled = false;
              buttonText.textContent = 'Create Shipment';
              
              // Offer to track the new shipment
              setTimeout(() => {
                if (confirm('Would you like to track your new shipment?')) {
                  TrackingSystem.showTrackingModal(trackingNumber);
                }
              }, 2000);
            }, 2000);
          }
        });
      },

      setupLoginForm() {
        const form = document.getElementById('loginForm');
        if (!form) return;

        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          
          const email = document.getElementById('loginEmail').value.trim();
          const password = document.getElementById('loginPassword').value;
          
          let isValid = true;
          
          if (!Utils.validateEmail(email)) {
            Utils.showError('loginEmail', 'loginEmailError', 'Please enter a valid email address.');
            isValid = false;
          } else {
            Utils.clearError('loginEmail', 'loginEmailError');
          }
          
          if (password.length < 6) {
            Utils.showError('loginPassword', 'passwordError', 'Password must be at least 6 characters.');
            isValid = false;
          } else {
            Utils.clearError('loginPassword', 'passwordError');
          }
          
          if (isValid) {
            const button = form.querySelector('button[type="submit"]');
            const buttonText = document.getElementById('loginButtonText');
            
            button.disabled = true;
            buttonText.textContent = 'Signing In...';
            
            setTimeout(() => {
              Notifications.show('Login Successful', 'Welcome back!', 'success');
              
              setTimeout(() => {
                Navigation.showPage('manage');
              }, 1500);
              
              button.disabled = false;
              buttonText.textContent = 'Sign In';
            }, 1500);
          }
        });
      },

      setupSignupForm() {
        const form = document.getElementById('signupForm');
        if (!form) return;

        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          
          const firstName = document.getElementById('firstName').value.trim();
          const lastName = document.getElementById('lastName').value.trim();
          const email = document.getElementById('signupEmail').value.trim();
          const password = document.getElementById('signupPassword').value;
          const confirmPassword = document.getElementById('confirmPassword').value;
          const termsAgree = document.getElementById('termsAgree').checked;
          
          let isValid = true;
          
          if (firstName.length < 2) {
            Utils.showError('firstName', 'firstNameError', 'Please enter your first name.');
            isValid = false;
          } else {
            Utils.clearError('firstName', 'firstNameError');
          }
          
          if (lastName.length < 2) {
            Utils.showError('lastName', 'lastNameError', 'Please enter your last name.');
            isValid = false;
          } else {
            Utils.clearError('lastName', 'lastNameError');
          }
          
          if (!Utils.validateEmail(email)) {
            Utils.showError('signupEmail', 'signupEmailError', 'Please enter a valid email address.');
            isValid = false;
          } else {
            Utils.clearError('signupEmail', 'signupEmailError');
          }
          
          if (password.length < 8) {
            Utils.showError('signupPassword', 'signupPasswordError', 'Password must be at least 8 characters.');
            isValid = false;
          } else {
            Utils.clearError('signupPassword', 'signupPasswordError');
          }
          
          if (password !== confirmPassword) {
            Utils.showError('confirmPassword', 'confirmPasswordError', 'Passwords do not match.');
            isValid = false;
          } else {
            Utils.clearError('confirmPassword', 'confirmPasswordError');
          }
          
          if (!termsAgree) {
            Utils.showError('termsAgree', 'termsCheck', 'You must agree to the terms and conditions.');
            isValid = false;
          } else {
            Utils.clearError('termsAgree', 'termsCheck');
          }
          
          if (isValid) {
            const button = form.querySelector('button[type="submit"]');
            const buttonText = document.getElementById('signupButtonText');
            
            button.disabled = true;
            buttonText.textContent = 'Creating Account...';
            
            setTimeout(() => {
              Notifications.show('Account Created', 'Please sign in with your new account.', 'success');
              
              form.reset();
              Utils.clearAllErrors(form);
              
              setTimeout(() => {
                Navigation.showPage('login');
              }, 2000);
              
              button.disabled = false;
              buttonText.textContent = 'Create Account';
            }, 2000);
          }
        });
      },

      setupContactForm() {
        const form = document.getElementById('contactForm');
        if (!form) return;

        form.addEventListener('submit', async (e) => {
          e.preventDefault();
          
          const name = document.getElementById('contactName').value.trim();
          const email = document.getElementById('contactEmail').value.trim();
          const subject = document.getElementById('contactSubject').value;
          const message = document.getElementById('contactMessage').value.trim();
          
          let isValid = true;
          
          if (name.length < 2) {
            Utils.showError('contactName', 'contactNameError', 'Please enter your name.');
            isValid = false;
          } else {
            Utils.clearError('contactName', 'contactNameError');
          }
          
          if (!Utils.validateEmail(email)) {
            Utils.showError('contactEmail', 'contactEmailError', 'Please enter a valid email address.');
            isValid = false;
          } else {
            Utils.clearError('contactEmail', 'contactEmailError');
          }
          
          if (!subject) {
            Utils.showError('contactSubject', 'contactSubjectError', 'Please select a subject.');
            isValid = false;
          } else {
            Utils.clearError('contactSubject', 'contactSubjectError');
          }
          
          if (message.length < 10) {
            Utils.showError('contactMessage', 'contactMessageError', 'Please enter a detailed message.');
            isValid = false;
          } else {
            Utils.clearError('contactMessage', 'contactMessageError');
          }
          
          if (isValid) {
            const button = form.querySelector('button[type="submit"]');
            const buttonText = document.getElementById('contactButtonText');
            
            button.disabled = true;
            buttonText.textContent = 'Sending...';
            
            setTimeout(() => {
              Notifications.show('Message Sent', 'We will respond within 24 hours.', 'success');
              
              form.reset();
              Utils.clearAllErrors(form);
              
              button.disabled = false;
              buttonText.textContent = 'Send Message';
            }, 1500);
          }
        });
      }
    };

    // External Actions
    const ExternalActions = {
      openDirections(address) {
        const url = `https://www.google.com/maps/dir/?api=1&destination=${encodeURIComponent(address)}`;
        window.open(url, '_blank', 'noopener,noreferrer');
      },

      callLocation(phone) {
        window.location.href = `tel:${phone}`;
      },

      callSupport() {
        window.location.href = 'tel:+18004633339';
      },

      startLiveChat() {
        Notifications.show('Live Chat', 'Connecting to customer service...', 'info');
        setTimeout(() => {
          Notifications.show('Chat Started', 'Connected with Sarah from customer service.', 'success');
        }, 2000);
      },

      searchLocations() {
        const query = document.getElementById('locationSearch').value.trim();
        if (query) {
          Notifications.show('Search', `Searching for locations near "${query}"...`, 'info');
        }
      }
    };

    // PDF Generation
    function generateTrackingPDF() {
      if (!AppState.currentTrackingData || !window.jsPDF) {
        Notifications.show('Error', 'Unable to generate PDF at this time.', 'error');
        return;
      }

      try {
        const doc = new window.jsPDF.jsPDF();
        const data = AppState.currentTrackingData;
        
        // Header
        doc.setFontSize(20);
        doc.setTextColor(77, 20, 140);
        doc.text('FedEx Shipment Tracking Report', 20, 20);
        
        // Content
        doc.setFontSize(12);
        doc.setTextColor(0, 0, 0);
        doc.text(`Generated: ${new Date().toLocaleString()}`, 20, 35);
        doc.text(`Tracking Number: ${data.trackingNumber}`, 20, 50);
        doc.text(`Status: ${data.status}`, 20, 65);
        doc.text(`Service: ${data.serviceType}`, 20, 80);
        doc.text(`Origin: ${data.origin}`, 20, 95);
        doc.text(`Destination: ${data.destination}`, 20, 110);
        
        // Tracking history
        doc.text('Tracking History:', 20, 130);
        data.history.forEach((event, index) => {
          const yPos = 145 + (index * 15);
          if (yPos < 280) {
            doc.text(`${event.date}: ${event.status} - ${event.location}`, 20, yPos);
          }
        });
        
        doc.save(`FedEx_Tracking_${data.trackingNumber}.pdf`);
        Notifications.show('Success', 'Tracking report downloaded!', 'success');
      } catch (error) {
        console.error('PDF generation failed:', error);
        Notifications.show('Error', 'Failed to generate PDF.', 'error');
      }
    }

    // Modal System
    const ModalSystem = {
      setup() {
        const modal = document.getElementById('trackingModal');
        
        // Close on outside click
        modal.addEventListener('click', (e) => {
          if (e.target === modal) {
            this.closeModal();
          }
        });
        
        // Close on Escape key
        document.addEventListener('keydown', (e) => {
          if (e.key === 'Escape' && modal.classList.contains('show')) {
            this.closeModal();
          }
        });
      },

      closeModal() {
        const modal = document.getElementById('trackingModal');
        modal.classList.remove('show');
        modal.setAttribute('aria-hidden', 'true');
        
        TrackingSystem.cleanup();
        
        // Reset modal content after animation
        setTimeout(() => {
          document.getElementById('modalBody').innerHTML = `
            <div class="flex-center">
              <div class="loading-spinner"></div>
            </div>
            <p class="text-center">Loading shipment details...</p>
          `;
        }, 300);
      }
    };

    // Global Functions (for HTML onclick handlers)
    window.showPage = (pageId) => Navigation.showPage(pageId);
    window.toggleMobileMenu = () => Navigation.toggleMobileMenu();
    window.showTrackingModal = (trackingNumber) => TrackingSystem.showTrackingModal(trackingNumber);
    window.closeModal = () => ModalSystem.closeModal();
    window.trackDemo = (trackingNumber) => {
      const input = document.getElementById('trackingPageInput') || document.getElementById('trackingInput');
      if (input) input.value = trackingNumber;
      TrackingSystem.showTrackingModal(trackingNumber);
    };
    window.handleKeyPress = (event, callback) => Utils.handleKeyPress(event, callback);
    window.openDirections = (address) => ExternalActions.openDirections(address);
    window.callLocation = (phone) => ExternalActions.callLocation(phone);
    window.callSupport = () => ExternalActions.callSupport();
    window.startLiveChat = () => ExternalActions.startLiveChat();
    window.searchLocations = () => ExternalActions.searchLocations();
    window.generateTrackingPDF = () => generateTrackingPDF();

    // Application Initialization
    function initializeApp() {
      try {
        // Initialize core systems
        Utils.initDarkMode();
        FormSystem.setupFormHandlers();
        ModalSystem.setup();
        
        // Initialize home page
        Navigation.showPage('home');
        
        // Show welcome notification
        setTimeout(() => {
          Notifications.show('Welcome to FedEx', 
            'Track packages, ship worldwide, and manage your logistics.', 'info');
        }, 1000);
        
        console.log('FedEx app initialized successfully');
      } catch (error) {
        console.error('App initialization error:', error);
        Notifications.show('Error', 'Failed to initialize application.', 'error');
      }
    }

    // Error Handlers
    window.addEventListener('error', (e) => {
      console.error('Application error:', e.error);
      Notifications.show('Error', 'An unexpected error occurred.', 'error');
    });

    window.addEventListener('unhandledrejection', (e) => {
      console.error('Unhandled promise rejection:', e.reason);
      Notifications.show('Error', 'A network error occurred.', 'error');
    });

    // Start the application
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initializeApp);
    } else {
      initializeApp();
    }
  </script>
</body>
</html>
